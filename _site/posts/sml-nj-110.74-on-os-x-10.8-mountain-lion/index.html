<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="I previously went over how to install SML on OS X via Homebrew, which currently installs version 110.74 of SML/NJ. Unfortunately, this version does not work ...">

    <title>SML/NJ 110.74 on OS X 10.8 Mountain Lion | islovely</title>

    <link rel="stylesheet" href="/style.css">
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Cardo:400,400italic,700|Source+Code+Pro">
    <link rel="canonical" href="http://islovely.co/posts/sml-nj-110.74-on-os-x-10.8-mountain-lion/">
  </head>

  <body>
    <header
        class="header">
      <a
          class="header__link"
          href="/">
        islovely
      </a>
    </header>

    <nav
        class="navigation">
      <ol
          class="navigation__list">
        <li
            class="navigation__item">
          <a
              class="navigation__link"
              href="/">
            Home
          </a>
        </li>
        <li
            class="navigation__item">
          <a
              class="navigation__link"
              href="/posts">
            Posts
          </a>
        </li>
        <li
            class="navigation__item">
          <a
              class="navigation__link"
              href="/about">
            About
          </a>
        </li>
        <li
            class="navigation__item">
          <a
              class="navigation__link"
              href="/contact">
            Contact
          </a>
        </li>
      </ol>
    </nav>

    <main>
      <nav
    class="back-navigation">
  <a
      class="back-navigation__link"
      href="/posts">
    &larr; Posts
  </a>
</nav>

<h1>
  SML/NJ 110.74 on OS X 10.8 Mountain Lion
</h1>

<p
    class="post__byline">
  by Dom Habersack (<a href="http://twitter.com/dhabersack">@dhabersack</a>), published Aug 5, 2012
</p>

<p>I previously went over <a href="#!/posts/painless-installation-of-sml-on-os-x" title="Painless installation of SML on OS X">how to install SML on OS X via Homebrew</a>, which currently installs version 110.74 of SML/NJ. Unfortunately, this version does not work with the recently released OS X 10.8 Mountain Lion out of the box. If you are running both SML and OS X at these version numbers, some light additional tuning is required.</p>

<p>Note that this bug <a href="http://smlnj-gforge.cs.uchicago.edu/tracker/index.php?func=detail&amp;aid=94&amp;group_id=33&amp;atid=215" title="smlnj-gforge: SML/NJ Bugs: Detail: 94 Running on OS X Mountain Lion">will be fixed in SML/NJ 110.75</a>. (<strong>Update:</strong> 110.75 is now available.)</p>

<p>When running version 110.74 on Mountain Lion, the command</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ sml
</code></pre></div>
<p>results in a not overly helpful but easily resolved error:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">sml: unable to determine architecture/operating system
</code></pre></div>
<p>What happens here is that SML is unable to handle the operating system number of Mountain Lion, so we need to tell it how to interpret that. In order to do so, we first need to figure out which directory Homebrew installed SML to. Running</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ brew info smlnj
</code></pre></div>
<p>gives us an output similar to the following:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">smlnj: stable 110.74
http://www.smlnj.org/
/usr/local/Cellar/smlnj/110.74 (3950 files, 69M) *
https://github.com/mxcl/homebrew/commits/master/Library/Formula/smlnj.rb
==&gt; Caveats
This formula spews ML files all over lib, and puts hidden subfolders in bin.
Because of this, we’ve installed it to:
  /usr/local/Cellar/smlnj/110.74/libexec
and we haven’t linked it into /usr/local

You’ll need to add:
  /usr/local/Cellar/smlnj/110.74/libexec/bin
to your PATH.

Improvements are welcome.
</code></pre></div>
<p>From this, we can tell that SML has been installed to <code>/usr/local/Cellar/smlnj/110.74/libexec</code>.</p>

<p>Open the file <code>bin/.arch-n-opsys</code> located in this directory in your text editor of choice:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ open -t /usr/local/Cellar/smlnj/110.74/libexec/bin/.arch-n-opsys
</code></pre></div>
<p>Inside, you will find the following instructions, starting at line 63:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">case `uname -r` in
   8*) OPSYS=darwin; HEAP_OPSYS=darwin ;; # MacOS X 10.4
   9*) OPSYS=darwin; HEAP_OPSYS=darwin ;; # MacOS X 10.5
  10*) OPSYS=darwin; HEAP_OPSYS=darwin ;; # MacOS X 10.6
  11*) OPSYS=darwin; HEAP_OPSYS=darwin ;; # MacOS X 10.7
    *) exit 1;;
</code></pre></div>
<p>As you may have noticed, OS X version 10.8 is not listed here yet. Simply add a line covering version number <em>12</em> (as returned by <code>uname -r</code>) to this list:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">case `uname -r` in
   8*) OPSYS=darwin; HEAP_OPSYS=darwin ;; # MacOS X 10.4
   9*) OPSYS=darwin; HEAP_OPSYS=darwin ;; # MacOS X 10.5
  10*) OPSYS=darwin; HEAP_OPSYS=darwin ;; # MacOS X 10.6
  11*) OPSYS=darwin; HEAP_OPSYS=darwin ;; # MacOS X 10.7
  12*) OPSYS=darwin; HEAP_OPSYS=darwin ;; # MacOS X 10.8
    *) exit 1;;
</code></pre></div>
<p>When trying to save the change, your text editor is probably going to tell you that the file is read-only, but you will have to overwrite the contents here.</p>

<p>After that, running</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ sml
</code></pre></div>
<p>will once again greet you with the expected command prompt.</p>


<aside
    class="author-bio">
  <h3>
    About Dom
  </h3>

  <div
      class="author-bio__content">
    <div
        class="author-bio__headshot-container">
      <img
          class="author-bio__headshot"
          src="/assets/dom.jpg">
    </div>

    <p
        class="author-bio__teaser">
      I work with companies on improving their products to serve their
      customers better. If your product does not meet your business goals,
      contact me at <a href="mailto:dom@islovely.co">dom@islovely.co</a>
      today so we can start working on a solution!
    </p>
  </div>
</aside>

    </main>

    <footer
        class="footer">
      <div
          class="footer__content">
        <p
            class="footer__about">
          Copyright &copy; 2015<br>
          Dom Habersack, <a href="mailto:dom@islovely.co">dom@islovely.co</a><br>
          Based in Munich, Germany.<br>
          <a href="/imprint">Imprint</a>
        </p>

        <ol
            class="footer__profiles">
          <li
              class="footer__profile">
            <a
                href="https://twitter.com/dhabersack">
              @dhabersack on Twitter
            </a>
          </li>
          <li
              class="footer__profile">
            <a
                href="https://github.com/dhabersack">
              dhabersack on GitHub
            </a>
          </li>
        </ol>
      </div>
    </footer>

    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('set', 'anonymizeIp', true);
    ga('create', 'UA-13202125-5', 'auto');
    ga('send', 'pageview');
    </script>
  </body>
</html>

<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Over the last few weeks, I have become a massive fan of Grunt. Amongst other things, it makes development with Sass and CoffeeScript much easier by running t...">

    <title>grunt-contrib-sass and Node.js 0.10.8 | islovely</title>

    <link rel="stylesheet" href="/style.css">
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Cardo:400,400italic,700|Source+Code+Pro">
    <link rel="canonical" href="http://islovely.co/posts/grunt-contrib-sass-and-node-js-0-10-8/">
  </head>

  <body>
    <header
        class="header">
      <a
          class="header__link"
          href="/">
        islovely
      </a>
    </header>

    <nav
        class="navigation">
      <ol
          class="navigation__list">
        <li
            class="navigation__item">
          <a
              class="navigation__link"
              href="/">
            Home
          </a>
        </li>
        <li
            class="navigation__item">
          <a
              class="navigation__link"
              href="/posts">
            Posts
          </a>
        </li>
        <li
            class="navigation__item">
          <a
              class="navigation__link"
              href="/about">
            About
          </a>
        </li>
        <li
            class="navigation__item">
          <a
              class="navigation__link"
              href="/contact">
            Contact
          </a>
        </li>
      </ol>
    </nav>

    <main>
      <nav
    class="back-navigation">
  <a
      class="back-navigation__link"
      href="/posts">
    &larr; Posts
  </a>
</nav>

<h1>
  grunt-contrib-sass and Node.js 0.10.8
</h1>

<p
    class="post__byline">
  by Dom Habersack (<a href="http://twitter.com/dhabersack">@dhabersack</a>), published May 29, 2013
</p>

<p>Over the last few weeks, I have become a massive fan of <a href="http://gruntjs.com/">Grunt</a>. Amongst other things, it makes development with <a href="http://sass-lang.com/">Sass</a> and <a href="http://coffeescript.org/">CoffeeScript</a> much easier by running their compile-processes automatically and reloading the browser via LiveReload. It basically gives you frontend-superpowers.</p>

<p>Grunt has given such a big boost to my productivity that suddenly losing part of it felt like the worst thing that could happen. Even more so considering that a client deadline was rapidly approaching at the time.</p>

<p>Seemingly out of nowhere, <a href="https://github.com/gruntjs/grunt-contrib-sass">grunt-contrib-sass</a> failed with the following error message:</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">Assertion failed:
<span class="o">(</span>!uv__io_active<span class="o">(</span><span class="p">&amp;</span>stream-&gt;io_watcher, UV_POLLOUT<span class="o">)</span>
<span class="o">||</span> !ngx_queue_empty<span class="o">(</span><span class="p">&amp;</span>stream-&gt;write_completed_queue<span class="o">)</span>
<span class="o">||</span> !ngx_queue_empty<span class="o">(</span><span class="p">&amp;</span>stream-&gt;write_queue<span class="o">)</span>
<span class="o">||</span> stream-&gt;shutdown_req !<span class="o">=</span> NULL
<span class="o">||</span> stream-&gt;connect_req !<span class="o">=</span> NULL<span class="o">)</span>, <span class="k">function</span> uv_read_stop,
file ../deps/uv/src/unix/stream.c, line 1319.
</code></pre></div>
<p>The source of the problem was surprisingly difficult to pin down, primarily because the error message is rather cryptic. Some assertion failed, that is nice. It even tells me the file and exact line this error occured on, which I tracked down to a file in the <a href="https://github.com/joyent/node/blob/master/deps/uv/src/unix/stream.c">Node.js-repository</a>:</p>
<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="n">s</span> <span class="o">=</span> <span class="n">handle</span><span class="o">-&gt;</span><span class="n">select</span><span class="p">;</span>
</code></pre></div>
<p>Unfortunately, this does not help at all.</p>

<p>It took a few good hours to figure out what had happened. Turns out that the innocent-looking</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>brew update
<span class="nv">$ </span>brew upgrade
</code></pre></div>
<p>I had run earlier to update all packages installed through
<a href="http://brew.sh/">Homebrew</a> also updated my installation of Node.js from version 0.10.6 to 0.10.8. However, that new version of Node.js does not currently work with grunt-contrib-sass.</p>

<p>To get it working again, we need to temporarily downgrade Node.js to an earlier version. Homebrew allows us to install different versions of the same package and switch between them.</p>

<p>First, you need to change to <code>/usr/local/</code>, which is where Homebrew lives by default:</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span><span class="nb">cd</span> /usr/local/
</code></pre></div>
<p>There you can request a list of all versions of <code>node</code> that are available via Homebrew:</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>brew versions node
0.10.8   git checkout ee99542 Library/Formula/node.rb
0.10.7   git checkout e44f345 Library/Formula/node.rb
0.10.6   git checkout <span class="m">8583540</span> Library/Formula/node.rb
0.10.5   git checkout 3b589c5 Library/Formula/node.rb
<span class="o">[</span>...<span class="o">]</span>
</code></pre></div>
<p>Homebrew even provides the <code>git</code>-command you need to run to install the version. Run these commands to install 0.10.7:</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>git checkout e44f345 Library/Formula/node.rb
<span class="nv">$ </span>brew unlink node
<span class="nv">$ </span>brew install node
</code></pre></div>
<p>After the installation is done, version 0.10.7 is going to be active, while 0.10.8 is still installed.</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>node --version
v0.10.7
<span class="nv">$ </span>brew list --versions node
node 0.10.7 0.10.8
</code></pre></div>
<p>With 0.10.7 active, grunt-contrib-sass once again purrs like a cat and does its thing.</p>

<p>If you want to switch between installed versions later, you can do so by running <code>brew switch &lt;formula&gt; &lt;version&gt;</code>:</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>brew switch node 0.10.8
Cleaning /usr/local/Cellar/node/0.10.7
Cleaning /usr/local/Cellar/node/0.10.8
<span class="m">5</span> links created <span class="k">for</span> /usr/local/Cellar/node/0.10.8
</code></pre></div>

<aside
    class="author-bio">
  <h3>
    About Dom
  </h3>

  <div
      class="author-bio__content">
    <div
        class="author-bio__headshot-container">
      <img
          class="author-bio__headshot"
          src="/assets/dom.jpg">
    </div>

    <p
        class="author-bio__teaser">
      I work with companies on improving their products to serve their
      customers better. If your product does not meet your business goals,
      contact me at <a href="mailto:dom@islovely.co">dom@islovely.co</a>
      today so we can start working on a solution!
    </p>
  </div>
</aside>

    </main>

    <footer
        class="footer">
      <div
          class="footer__content">
        <p
            class="footer__about">
          Copyright &copy; 2015<br>
          Dom Habersack, <a href="mailto:dom@islovely.co">dom@islovely.co</a><br>
          Based in Munich, Germany.<br>
          <a href="/imprint">Imprint</a>
        </p>

        <ol
            class="footer__profiles">
          <li
              class="footer__profile">
            <a
                href="https://twitter.com/dhabersack">
              @dhabersack on Twitter
            </a>
          </li>
          <li
              class="footer__profile">
            <a
                href="https://github.com/dhabersack">
              dhabersack on GitHub
            </a>
          </li>
        </ol>
      </div>
    </footer>

    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('set', 'anonymizeIp', true);
    ga('create', 'UA-13202125-5', 'auto');
    ga('send', 'pageview');
    </script>
  </body>
</html>

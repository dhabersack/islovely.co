<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="description" content="Additional configuration is required to make Mountain Lion and the version of SML/NJ currently being installed via Homebrew play together nicely again.">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">

    <title>SML/NJ 110.74 on OS X 10.8 Mountain Lion | islovely</title>

    <link rel="stylesheet" href="/style.css">
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Lato:400|PT+Serif:400,400italic,700|Source+Code+Pro">
    <noscript><link rel="stylesheet" href="/icons.fallback.css"></noscript>
  </head>

  <body>
    <header role="banner">
      <a href="/">islovely</a>
    </header>

    <nav role="navigation">
      <ol>
        <li><a href="/">Home</a>
        <li><a href="/projects">Projects</a>
        <li><a href="/posts">Posts</a>
        <li><a href="/about">About</a>
        <li><a href="/contact">Contact</a>
      </ol>
    </nav>

    <main role="main">


<h1>SML/NJ 110.74 on OS X 10.8 Mountain Lion</h1>

<p>I previously went over <a href="#!/posts/painless-installation-of-sml-on-os-x" title="Painless installation of SML on OS X">how to install SML on OS X via Homebrew</a>, which currently installs version 110.74 of SML/NJ. Unfortunately, this version does not work with the recently released OS X 10.8 Mountain Lion out of the box. If you are running both SML and OS X at these version numbers, some light additional tuning is required.</p>

<p>Note that this bug <a href="http://smlnj-gforge.cs.uchicago.edu/tracker/index.php?func=detail&amp;aid=94&amp;group_id=33&amp;atid=215" title="smlnj-gforge: SML/NJ Bugs: Detail: 94 Running on OS X Mountain Lion">will be fixed in SML/NJ 110.75</a>. (<strong>Update:</strong> 110.75 is now available.)</p>

<p>When running version 110.74 on Mountain Lion, the command</p>

<p><code>
$ sml
</code></p>

<p>results in a not overly helpful but easily resolved error:</p>

<p><code>
sml: unable to determine architecture/operating system
</code></p>

<p>What happens here is that SML is unable to handle the operating system number of Mountain Lion, so we need to tell it how to interpret that. In order to do so, we first need to figure out which directory Homebrew installed SML to. Running</p>

<p><code>
$ brew info smlnj
</code></p>

<p>gives us an output similar to the following:</p>

<p>```
smlnj: stable 110.74
http://www.smlnj.org/
/usr/local/Cellar/smlnj/110.74 (3950 files, 69M) *
https://github.com/mxcl/homebrew/commits/master/Library/Formula/smlnj.rb
==&gt; Caveats
This formula spews ML files all over lib, and puts hidden subfolders in bin.
Because of this, we’ve installed it to:
  /usr/local/Cellar/smlnj/110.74/libexec
and we haven’t linked it into /usr/local</p>

<p>You’ll need to add:
  /usr/local/Cellar/smlnj/110.74/libexec/bin
to your PATH.</p>

<p>Improvements are welcome.
```</p>

<p>From this, we can tell that SML has been installed to <code>/usr/local/Cellar/smlnj/110.74/libexec</code>.</p>

<p>Open the file <code>bin/.arch-n-opsys</code> located in this directory in your text editor of choice:</p>

<p><code>
$ open -t /usr/local/Cellar/smlnj/110.74/libexec/bin/.arch-n-opsys
</code></p>

<p>Inside, you will find the following instructions, starting at line 63:</p>

<p><code>
case `uname -r` in
   8*) OPSYS=darwin; HEAP_OPSYS=darwin ;; # MacOS X 10.4
   9*) OPSYS=darwin; HEAP_OPSYS=darwin ;; # MacOS X 10.5
  10*) OPSYS=darwin; HEAP_OPSYS=darwin ;; # MacOS X 10.6
  11*) OPSYS=darwin; HEAP_OPSYS=darwin ;; # MacOS X 10.7
    *) exit 1;;
</code></p>

<p>As you may have noticed, OS X version 10.8 is not listed here yet. Simply add a line covering version number <em>12</em> (as returned by <code>uname -r</code>) to this list:</p>

<p><code>
case `uname -r` in
   8*) OPSYS=darwin; HEAP_OPSYS=darwin ;; # MacOS X 10.4
   9*) OPSYS=darwin; HEAP_OPSYS=darwin ;; # MacOS X 10.5
  10*) OPSYS=darwin; HEAP_OPSYS=darwin ;; # MacOS X 10.6
  11*) OPSYS=darwin; HEAP_OPSYS=darwin ;; # MacOS X 10.7
  12*) OPSYS=darwin; HEAP_OPSYS=darwin ;; # MacOS X 10.8
    *) exit 1;;
</code></p>

<p>When trying to save the change, your text editor is probably going to tell you that the file is read-only, but you will have to overwrite the contents here.</p>

<p>After that, running</p>

<p><code>
$ sml
</code></p>

<p>will once again greet you with the expected command prompt.</p>


    </main>

    <footer role="contentinfo">
        <p>
          Copyright &copy; 2014<br>
          Dom Habersack, <a href="/" title="Portfolio of Dom Habersack">islovely.co</a><br>
          
        </p>

        <ul>
          <li>
            <a href="http://github.com/dhabersack" class="logo-github">GitHub</a>
          </li>
          <li>
            <a href="http://twitter.com/dhabersack" class="logo-twitter">Twitter</a>
          </li>
        </ul>

        <form action="http://islovely.us5.list-manage.com/subscribe/post?u=fefc2ec4108769b84b68f81f7&amp;id=1e9d2ac4ec" method="post" name="mc-embedded-subscribe-form" target="_blank" novalidate>
          <p>
            Learn how to use code to solve problems on <a href="http://problemthinking.org">my newsletter</a>:
          </p>

          <input type="email" name="EMAIL" id="mce-email" placeholder="you@yourdomain.com">

          <input type="text" style="position: absolute; left: -5000px;" name="b_fefc2ec4108769b84b68f81f7_1e9d2ac4ec" value="">

          <button type="submit" name="subscribe">Sign up</button>
        </form>
      </div>
    </footer>

    <script>
    window.grunticon=function(e){if(e&&3===e.length){var t=window,n=!(!t.document.createElementNS||!t.document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect||!document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Image","1.1")||window.opera&&-1===navigator.userAgent.indexOf("Chrome")),o=function(o){var r=t.document.createElement("link"),a=t.document.getElementsByTagName("script")[0];r.rel="stylesheet",r.href=e[o&&n?0:o?1:2],a.parentNode.insertBefore(r,a)},r=new t.Image;r.onerror=function(){o(!1)},r.onload=function(){o(1===r.width&&1===r.height)},r.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw=="}};
    grunticon(['icons.svg.css', 'icons.png.css', 'icons.fallback.css']);
    </script>

    <script>
    (function(i, s, o, g, r, a, m) {
      i['GoogleAnalyticsObject'] = r;
      i[r] = i[r] || function() {
        (i[r].q = i[r].q || []).push(arguments)
      },
      i[r].l = 1 * new Date();
      a = s.createElement(o),
      m = s.getElementsByTagName(o)[0];
      a.async = 1;
      a.src = g;
      m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

    ga('create', 'UA-13202125-5', 'islovely.co');
    ga('set', 'anonymizeIp', true);
    </script>
  </body>
</html>

